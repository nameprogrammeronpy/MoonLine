<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Self-Care Toolkit - MoonLine</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #000000;
            --bg-gradient: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
            --accent-peach: #ffb4a2;
            --accent-mint: #a7f3d0;
            --accent-coral: #e5989b;
            --accent-glow: #ff8c42;
            --text-white: #FFFFFF;
            --text-gray: #9CA3AF;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Poppins', sans-serif;
            background: var(--bg-dark);
            min-height: 100vh;
            color: var(--text-white);
        }

        /* Navbar */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 1000;
            padding: 15px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-white);
            text-decoration: none;
            font-size: 1.4rem;
            font-weight: 600;
        }

        .nav-logo svg { width: 28px; height: 28px; }

        .nav-links {
            display: flex;
            gap: 35px;
            list-style: none;
        }

        .nav-links a {
            color: var(--text-gray);
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s;
        }

        .nav-links a:hover, .nav-links a.active { color: var(--text-white); }

        .nav-right {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .nav-btn {
            padding: 10px 25px;
            background: var(--accent-glow);
            color: #000;
            border: none;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s;
        }

        .nav-btn:hover { box-shadow: 0 0 20px rgba(255,140,66,0.4); transform: translateY(-2px); }

        /* Theme Toggle */
        .theme-toggle { display: flex; align-items: center; }
        .switch { position: relative; display: inline-block; }
        .switch__input {
            background-color: var(--accent-glow);
            border-radius: 0.75em;
            outline: transparent;
            position: relative;
            width: 3em;
            height: 1.5em;
            -webkit-appearance: none;
            appearance: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .switch__input:checked { background-color: #a7f3d0; }
        .switch__input:before {
            content: "";
            position: absolute;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: inherit;
            inset: 0;
        }
        .switch__input:after {
            content: "";
            position: absolute;
            background-color: white;
            border-radius: 50%;
            top: 0.125em;
            left: 0.125em;
            width: 1.25em;
            height: 1.25em;
            transition: transform 0.3s ease;
        }
        .switch__input:checked:after { transform: translateX(1.5em); }
        .switch__icon {
            position: absolute;
            top: 0.375em;
            width: 0.75em;
            height: 0.75em;
            pointer-events: none;
            transition: opacity 0.3s, transform 0.3s;
        }
        .switch__icon--light { right: 0.375em; opacity: 1; }
        .switch__icon--dark { right: 0.375em; opacity: 0; transform: translateX(-0.75em) rotate(30deg) scale(0.75); }
        .switch__input:checked ~ .switch__icon--light { opacity: 0; transform: translateX(-0.75em) rotate(-30deg) scale(0.75); }
        .switch__input:checked ~ .switch__icon--dark { opacity: 1; transform: translateX(-1.5em); }

        /* Light Mode */
        body.light-mode { background: #fff8f5; color: #1a1a1a; }
        body.light-mode .navbar { background: rgba(255,255,255,0.9); border-color: rgba(0,0,0,0.05); }
        body.light-mode .nav-logo, body.light-mode .nav-links a.active { color: #1a1a1a; }
        body.light-mode .nav-links a { color: #555; }
        body.light-mode .hero { background: linear-gradient(135deg, #fff0eb 0%, #ffeee6 100%); }
        body.light-mode .hero h1, body.light-mode .section-title { color: #1a1a1a; }
        body.light-mode .hero p { color: #555; }
        body.light-mode .tool-card { background: rgba(255,255,255,0.9); border-color: rgba(0,0,0,0.1); }
        body.light-mode .tool-card h3 { color: #1a1a1a; }
        body.light-mode .tool-card p { color: #555; }

        /* Hero */
        .hero {
            padding: 140px 120px 80px;
            text-align: center;
            background: var(--bg-gradient);
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .hero p {
            font-size: 1.2rem;
            color: var(--text-gray);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Tools Grid */
        .tools-section {
            padding: 80px 120px;
        }

        .section-title {
            font-size: 2rem;
            text-align: center;
            margin-bottom: 50px;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
        }

        .tool-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 24px;
            padding: 35px;
            transition: all 0.4s ease;
            cursor: pointer;
        }

        .tool-card:hover {
            transform: translateY(-8px);
            border-color: rgba(255, 180, 162, 0.3);
            box-shadow: 0 20px 50px rgba(255, 140, 66, 0.2);
        }

        .tool-icon {
            width: 60px;
            height: 60px;
            border-radius: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        .tool-icon svg {
            width: 28px;
            height: 28px;
            stroke-width: 1.5;
        }

        /* Warm color palette for tool icons */
        .tool-icon-breath { background: rgba(255, 180, 162, 0.15); }
        .tool-icon-breath svg { stroke: #ffb4a2; }

        .tool-icon-ground { background: rgba(167, 243, 208, 0.15); }
        .tool-icon-ground svg { stroke: #a7f3d0; }

        .tool-icon-mood { background: rgba(252, 213, 206, 0.15); }
        .tool-icon-mood svg { stroke: #fcd5ce; }

        .tool-icon-gratitude { background: rgba(241, 166, 106, 0.15); }
        .tool-icon-gratitude svg { stroke: #f1a66a; }

        .tool-icon-sounds { background: rgba(181, 131, 141, 0.15); }
        .tool-icon-sounds svg { stroke: #b5838d; }

        .tool-icon-muscle { background: rgba(229, 152, 155, 0.15); }
        .tool-icon-muscle svg { stroke: #e5989b; }

        .tool-card h3 {
            font-size: 1.3rem;
            margin-bottom: 12px;
        }

        .tool-card p {
            color: var(--text-gray);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .tool-time {
            display: inline-block;
            padding: 5px 12px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            font-size: 0.8rem;
            color: var(--text-gray);
            margin-bottom: 20px;
        }

        .tool-btn {
            width: 100%;
            padding: 12px;
            background: transparent;
            border: 2px solid rgba(255, 180, 162, 0.5);
            border-radius: 12px;
            color: var(--accent-peach);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .tool-btn:hover {
            background: var(--accent-peach);
            color: black;
            box-shadow: 0 0 25px rgba(255, 140, 66, 0.4);
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
        }

        .modal-overlay.active { display: flex; }

        .modal-content {
            background: #1a1a2e;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 10;
        }

        .modal-close:hover { background: rgba(255, 255, 255, 0.2); }

        .modal-header {
            padding: 30px 30px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .modal-header h2 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .modal-header p {
            color: var(--text-gray);
        }

        .modal-body { padding: 30px; }

        /* Breathing Exercise */
        .breathing-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 0;
        }

        .breathing-circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.3), rgba(59, 130, 246, 0.3));
            border: 3px solid var(--accent-purple);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            transition: all 4s ease;
        }

        .breathing-circle.inhale {
            transform: scale(1.3);
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.5), rgba(59, 130, 246, 0.5));
        }

        .breathing-circle.hold {
            transform: scale(1.3);
        }

        .breathing-circle.exhale {
            transform: scale(1);
        }

        .breathing-text {
            font-size: 1.2rem;
            font-weight: 600;
        }

        .breathing-instruction {
            font-size: 1.3rem;
            text-align: center;
            margin-bottom: 20px;
            min-height: 40px;
        }

        .breathing-counter {
            font-size: 0.9rem;
            color: var(--text-gray);
        }

        .exercise-btn {
            padding: 14px 40px;
            background: linear-gradient(135deg, var(--accent-purple), #7C3AED);
            border: none;
            border-radius: 30px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
        }

        .exercise-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(139, 92, 246, 0.4);
        }

        /* Grounding Exercise */
        .grounding-steps {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .grounding-step {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            padding: 20px;
            display: none;
        }

        .grounding-step.active { display: block; }

        .grounding-step h4 {
            font-size: 1.1rem;
            margin-bottom: 15px;
            color: var(--accent-purple);
        }

        .grounding-inputs {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .grounding-inputs input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            color: white;
            font-size: 0.95rem;
            outline: none;
        }

        .grounding-inputs input:focus {
            border-color: var(--accent-purple);
        }

        .grounding-progress {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
        }

        .progress-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
        }

        .progress-dot.active { background: var(--accent-purple); }
        .progress-dot.completed { background: #4ADE80; }

        .completion-message {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .completion-message.active { display: block; }

        .completion-message h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #4ADE80;
        }

        /* Mood Check */
        .mood-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
        }

        .mood-option {
            font-size: 3rem;
            cursor: pointer;
            transition: all 0.3s;
            opacity: 0.5;
        }

        .mood-option:hover, .mood-option.selected {
            transform: scale(1.2);
            opacity: 1;
        }

        .mood-textarea {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: white;
            font-family: inherit;
            font-size: 0.95rem;
            resize: vertical;
            outline: none;
            margin-top: 20px;
        }

        .mood-textarea:focus { border-color: var(--accent-purple); }

        /* Sounds Player */
        .sounds-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .sound-option {
            padding: 20px 15px;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .sound-option:hover { background: rgba(255, 255, 255, 0.08); }
        .sound-option.active {
            border-color: var(--accent-purple);
            background: rgba(139, 92, 246, 0.15);
        }

        .sound-icon { font-size: 2rem; margin-bottom: 8px; }
        .sound-name { font-size: 0.9rem; }

        .sound-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .volume-control {
            display: flex;
            align-items: center;
            gap: 15px;
            width: 100%;
            max-width: 300px;
        }

        .volume-slider {
            flex: 1;
            height: 6px;
            -webkit-appearance: none;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            outline: none;
        }

        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--accent-purple);
            border-radius: 50%;
            cursor: pointer;
        }

        .timer-options {
            display: flex;
            gap: 10px;
        }

        .timer-btn {
            padding: 8px 16px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 20px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .timer-btn:hover, .timer-btn.active {
            background: var(--accent-purple);
        }

        /* Benefits Card */
        .benefits-section {
            padding: 80px 120px;
            background: var(--bg-purple);
        }

        .benefits-card {
            max-width: 700px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 40px;
        }

        .benefits-card h3 {
            font-size: 1.5rem;
            text-align: center;
            margin-bottom: 30px;
        }

        .benefits-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .benefit-item {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1rem;
        }

        .benefit-check {
            color: #4ADE80;
            font-size: 1.3rem;
        }

        /* Routine Section */
        .routine-section {
            padding: 80px 120px;
        }

        .routine-timeline {
            max-width: 600px;
            margin: 0 auto;
            position: relative;
        }

        .routine-timeline::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(180deg, var(--accent-purple), transparent);
        }

        .routine-item {
            display: flex;
            gap: 25px;
            margin-bottom: 35px;
            position: relative;
        }

        .routine-dot {
            width: 42px;
            height: 42px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-purple), var(--accent-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            flex-shrink: 0;
        }

        .routine-content h4 {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .routine-content p {
            color: var(--text-gray);
            font-size: 0.9rem;
        }

        /* Footer */
        .footer {
            padding: 30px 120px;
            text-align: center;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            color: var(--text-gray);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .hero, .tools-section, .benefits-section, .routine-section, .footer {
                padding-left: 60px;
                padding-right: 60px;
            }
            .tools-grid { grid-template-columns: repeat(2, 1fr); }
            .sounds-grid { grid-template-columns: repeat(2, 1fr); }
        }

        @media (max-width: 768px) {
            .navbar { padding: 15px 20px; }
            .nav-links { display: none; }
            .hero, .tools-section, .benefits-section, .routine-section, .footer {
                padding-left: 20px;
                padding-right: 20px;
            }
            .hero h1 { font-size: 2.5rem; }
            .tools-grid { grid-template-columns: 1fr; }
            .sounds-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar">
        <a href="/" class="nav-logo">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
            MoonLine
        </a>
        <ul class="nav-links">
            <li><a href="/">Home</a></li>
            <li><a href="/luna-ai">Luna AI</a></li>
            <li><a href="/toolkit" class="active">Self-Care Toolkit</a></li>
            <li><a href="/journal">Emotion Journal</a></li>
            <li><a href="/pricing">Pricing</a></li>
        </ul>
        <div class="nav-right">
            <div class="theme-toggle">
                <label class="switch">
                    <input class="switch__input" type="checkbox" role="switch" id="theme-switch">
                    <svg class="switch__icon switch__icon--light" viewBox="0 0 12 12" width="12px" height="12px">
                        <g fill="none" stroke="#fff" stroke-width="1" stroke-linecap="round">
                            <circle cx="6" cy="6" r="2" />
                            <g stroke-dasharray="1.5 1.5">
                                <polyline points="6 10,6 11.5" transform="rotate(0,6,6)" />
                                <polyline points="6 10,6 11.5" transform="rotate(45,6,6)" />
                                <polyline points="6 10,6 11.5" transform="rotate(90,6,6)" />
                                <polyline points="6 10,6 11.5" transform="rotate(135,6,6)" />
                                <polyline points="6 10,6 11.5" transform="rotate(180,6,6)" />
                                <polyline points="6 10,6 11.5" transform="rotate(225,6,6)" />
                                <polyline points="6 10,6 11.5" transform="rotate(270,6,6)" />
                                <polyline points="6 10,6 11.5" transform="rotate(315,6,6)" />
                            </g>
                        </g>
                    </svg>
                    <svg class="switch__icon switch__icon--dark" viewBox="0 0 12 12" width="12px" height="12px">
                        <g fill="none" stroke="#fff" stroke-width="1" stroke-linejoin="round" transform="rotate(-45,6,6)">
                            <path d="m9,10c-2.209,0-4-1.791-4-4s1.791-4,4-4c.304,0,.598.041.883.105-.995-.992-2.367-1.605-3.883-1.605C2.962.5.5,2.962.5,6s2.462,5.5,5.5,5.5c1.516,0,2.888-.613,3.883-1.605-.285.064-.578.105-.883.105Z"/>
                        </g>
                    </svg>
                </label>
            </div>
            {% if logged_in %}
            <a href="/dashboard" class="nav-btn">Dashboard</a>
            {% else %}
            <a href="/" class="nav-btn">Login</a>
            {% endif %}
        </div>
    </nav>

    <!-- Hero -->
    <section class="hero">
        <h1>Your Self-Care Toolkit</h1>
        <p>Evidence-based practices designed by mental health professionals. All tools are free for everyone.</p>
    </section>

    <!-- Tools Grid -->
    <section class="tools-section">
        <h2 class="section-title">Interactive Tools</h2>
        <div class="tools-grid">
            <!-- Breathing Exercise -->
            <div class="tool-card" onclick="openModal('breathing')">
                <div class="tool-icon tool-icon-breath">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
                </div>
                <h3>Breathing Exercise</h3>
                <p>4-7-8 breathing technique to reduce anxiety and promote calm.</p>
                <span class="tool-time">3-5 min</span>
                <button class="tool-btn">Start Practice</button>
            </div>

            <!-- Grounding -->
            <div class="tool-card" onclick="openModal('grounding')">
                <div class="tool-icon tool-icon-ground">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><line x1="2" y1="12" x2="22" y2="12"/><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"/></svg>
                </div>
                <h3>5-4-3-2-1 Grounding</h3>
                <p>A sensory technique to bring you back to the present moment.</p>
                <span class="tool-time">5 min</span>
                <button class="tool-btn">Start Practice</button>
            </div>

            <!-- Mood Check -->
            <div class="tool-card" onclick="openModal('mood')">
                <div class="tool-icon tool-icon-mood">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg>
                </div>
                <h3>Mood Check-In</h3>
                <p>Take a moment to identify and acknowledge how you're feeling.</p>
                <span class="tool-time">2 min</span>
                <button class="tool-btn">Start Practice</button>
            </div>

            <!-- Gratitude -->
            <div class="tool-card" onclick="openModal('gratitude')">
                <div class="tool-icon tool-icon-gratitude">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                </div>
                <h3>Gratitude Prompt</h3>
                <p>Shift your focus to the positive with a daily gratitude practice.</p>
                <span class="tool-time">3 min</span>
                <button class="tool-btn">Start Practice</button>
            </div>

            <!-- Sounds -->
            <div class="tool-card" onclick="openModal('sounds')">
                <div class="tool-icon tool-icon-sounds">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 18v-6a9 9 0 0 1 18 0v6"/><path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z"/></svg>
                </div>
                <h3>Ambient Sounds</h3>
                <p>Relaxing soundscapes to help you focus, relax, or sleep.</p>
                <span class="tool-time">5-15 min</span>
                <button class="tool-btn">Start Practice</button>
            </div>

            <!-- Muscle Relaxation -->
            <div class="tool-card" onclick="openModal('muscle')">
                <div class="tool-icon tool-icon-muscle">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
                </div>
                <h3>Muscle Relaxation</h3>
                <p>Progressive muscle relaxation to release physical tension.</p>
                <span class="tool-time">10 min</span>
                <button class="tool-btn">Start Practice</button>
            </div>
        </div>
    </section>

    <!-- Benefits (logged in only) -->
    {% if logged_in %}
    <section class="benefits-section">
        <div class="benefits-card">
            <h3>Your Practice Benefits</h3>
            <div class="benefits-list">
                <div class="benefit-item">
                    <span class="benefit-check">‚úì</span>
                    <span>All practices saved to your history</span>
                </div>
                <div class="benefit-item">
                    <span class="benefit-check">‚úì</span>
                    <span>Track your usage and favorite exercises</span>
                </div>
                <div class="benefit-item">
                    <span class="benefit-check">‚úì</span>
                    <span>Set daily reminders for your routine</span>
                </div>
                <div class="benefit-item">
                    <span class="benefit-check">‚úì</span>
                    <span>Export your practice log anytime</span>
                </div>
            </div>
        </div>
    </section>
    {% endif %}

    <!-- Daily Routine -->
    <section class="routine-section">
        <h2 class="section-title">Suggested Daily Routine</h2>
        <div class="routine-timeline">
            <div class="routine-item">
                <div class="routine-dot">üåÖ</div>
                <div class="routine-content">
                    <h4>Morning</h4>
                    <p>5-min breathing + gratitude prompt</p>
                </div>
            </div>
            <div class="routine-item">
                <div class="routine-dot">‚òÄÔ∏è</div>
                <div class="routine-content">
                    <h4>Midday</h4>
                    <p>Quick 5-4-3-2-1 grounding exercise</p>
                </div>
            </div>
            <div class="routine-item">
                <div class="routine-dot">üåô</div>
                <div class="routine-content">
                    <h4>Evening</h4>
                    <p>Ambient sounds + muscle relaxation</p>
                </div>
            </div>
            <div class="routine-item">
                <div class="routine-dot">üìä</div>
                <div class="routine-content">
                    <h4>Weekly</h4>
                    <p>Review your mood patterns and progress</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <p>¬© 2024 MoonLine. Made with care for your mental wellbeing.</p>
    </footer>

    <!-- Modals -->
    <!-- Breathing Modal -->
    <div class="modal-overlay" id="breathingModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('breathing')">&times;</button>
            <div class="modal-header">
                <h2>üå¨Ô∏è Breathing Exercise</h2>
                <p>4-7-8 technique to calm your nervous system</p>
            </div>
            <div class="modal-body">
                <div class="breathing-container">
                    <div class="breathing-circle" id="breathingCircle">
                        <span class="breathing-text" id="breathingText">Ready</span>
                    </div>
                    <p class="breathing-instruction" id="breathingInstruction">Click Start to begin</p>
                    <p class="breathing-counter" id="breathingCounter">Cycles completed: 0</p>
                    <button class="exercise-btn" id="breathingBtn" onclick="startBreathing()">Start</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Grounding Modal -->
    <div class="modal-overlay" id="groundingModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('grounding')">&times;</button>
            <div class="modal-header">
                <h2>üåç 5-4-3-2-1 Grounding</h2>
                <p>Use your senses to anchor to the present</p>
            </div>
            <div class="modal-body">
                <div class="grounding-progress" id="groundingProgress">
                    <div class="progress-dot active"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                    <div class="progress-dot"></div>
                </div>
                <div class="grounding-steps" id="groundingSteps">
                    <div class="grounding-step active" data-step="1">
                        <h4>Name 5 things you can SEE üëÄ</h4>
                        <div class="grounding-inputs" id="seeInputs"></div>
                        <button class="exercise-btn" onclick="nextGroundingStep(1)">Next</button>
                    </div>
                    <div class="grounding-step" data-step="2">
                        <h4>Name 4 things you can TOUCH üñêÔ∏è</h4>
                        <div class="grounding-inputs" id="touchInputs"></div>
                        <button class="exercise-btn" onclick="nextGroundingStep(2)">Next</button>
                    </div>
                    <div class="grounding-step" data-step="3">
                        <h4>Name 3 things you can HEAR üëÇ</h4>
                        <div class="grounding-inputs" id="hearInputs"></div>
                        <button class="exercise-btn" onclick="nextGroundingStep(3)">Next</button>
                    </div>
                    <div class="grounding-step" data-step="4">
                        <h4>Name 2 things you can SMELL üëÉ</h4>
                        <div class="grounding-inputs" id="smellInputs"></div>
                        <button class="exercise-btn" onclick="nextGroundingStep(4)">Next</button>
                    </div>
                    <div class="grounding-step" data-step="5">
                        <h4>Name 1 thing you can TASTE üëÖ</h4>
                        <div class="grounding-inputs" id="tasteInputs"></div>
                        <button class="exercise-btn" onclick="nextGroundingStep(5)">Complete</button>
                    </div>
                </div>
                <div class="completion-message" id="groundingComplete">
                    <h3>‚ú® Great work!</h3>
                    <p>You're present and grounded. Take a deep breath.</p>
                    <button class="exercise-btn" onclick="resetGrounding()">Do Again</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Mood Modal -->
    <div class="modal-overlay" id="moodModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('mood')">&times;</button>
            <div class="modal-header">
                <h2>üòä Mood Check-In</h2>
                <p>How are you feeling right now?</p>
            </div>
            <div class="modal-body">
                <div class="mood-selector">
                    <span class="mood-option" data-mood="5" onclick="selectMood(5)">üòä</span>
                    <span class="mood-option" data-mood="4" onclick="selectMood(4)">üôÇ</span>
                    <span class="mood-option" data-mood="3" onclick="selectMood(3)">üòê</span>
                    <span class="mood-option" data-mood="2" onclick="selectMood(2)">üòî</span>
                    <span class="mood-option" data-mood="1" onclick="selectMood(1)">üò¢</span>
                </div>
                <textarea class="mood-textarea" placeholder="Want to share more? (optional)"></textarea>
                <button class="exercise-btn" onclick="submitMood()">Save Check-In</button>
                {% if not logged_in %}
                <p style="text-align: center; margin-top: 15px; font-size: 0.85rem; color: var(--text-gray);">
                    ‚ö†Ô∏è Your response won't be saved. <a href="/" style="color: var(--accent-purple);">Sign up</a> to track your mood over time.
                </p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Gratitude Modal -->
    <div class="modal-overlay" id="gratitudeModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('gratitude')">&times;</button>
            <div class="modal-header">
                <h2>‚ú® Gratitude Prompt</h2>
                <p id="gratitudePrompt">What made you smile today?</p>
            </div>
            <div class="modal-body">
                <textarea class="mood-textarea" id="gratitudeText" placeholder="Write your thoughts..."></textarea>
                <button class="exercise-btn" onclick="submitGratitude()">Save</button>
                {% if not logged_in %}
                <p style="text-align: center; margin-top: 15px; font-size: 0.85rem; color: var(--text-gray);">
                    ‚ö†Ô∏è Your response won't be saved. <a href="/" style="color: var(--accent-purple);">Sign up</a> to build your gratitude journal.
                </p>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Sounds Modal -->
    <div class="modal-overlay" id="soundsModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('sounds'); stopAllSounds()">&times;</button>
            <div class="modal-header">
                <h2>üéß Ambient Sounds</h2>
                <p>Choose a soundscape to relax</p>
            </div>
            <div class="modal-body">
                <div class="sounds-grid">
                    <div class="sound-option" data-sound="rain" onclick="selectSound('rain')">
                        <div class="sound-icon">üåßÔ∏è</div>
                        <div class="sound-name">Rain</div>
                    </div>
                    <div class="sound-option" data-sound="ocean" onclick="selectSound('ocean')">
                        <div class="sound-icon">üåä</div>
                        <div class="sound-name">Ocean Waves</div>
                    </div>
                    <div class="sound-option" data-sound="forest" onclick="selectSound('forest')">
                        <div class="sound-icon">üå≤</div>
                        <div class="sound-name">Forest</div>
                    </div>
                    <div class="sound-option" data-sound="fire" onclick="selectSound('fire')">
                        <div class="sound-icon">üî•</div>
                        <div class="sound-name">Fireplace</div>
                    </div>
                    <div class="sound-option" data-sound="white" onclick="selectSound('white')">
                        <div class="sound-icon">üìª</div>
                        <div class="sound-name">White Noise</div>
                    </div>
                    <div class="sound-option" data-sound="thunder" onclick="selectSound('thunder')">
                        <div class="sound-icon">‚õàÔ∏è</div>
                        <div class="sound-name">Thunderstorm</div>
                    </div>
                </div>
                <div class="sound-controls">
                    <div class="volume-control">
                        <span>üîà</span>
                        <input type="range" class="volume-slider" min="0" max="100" value="70" id="volumeSlider">
                        <span>üîä</span>
                    </div>
                    <div class="timer-options">
                        <button class="timer-btn" onclick="setTimer(5)">5min</button>
                        <button class="timer-btn" onclick="setTimer(10)">10min</button>
                        <button class="timer-btn" onclick="setTimer(15)">15min</button>
                        <button class="timer-btn active" onclick="setTimer(0)">‚àû</button>
                    </div>
                    <button class="exercise-btn" id="playBtn" onclick="toggleSound()">‚ñ∂Ô∏è Play</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Muscle Relaxation Modal -->
    <div class="modal-overlay" id="muscleModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal('muscle')">&times;</button>
            <div class="modal-header">
                <h2>üßò Progressive Muscle Relaxation</h2>
                <p>Release tension from your body</p>
            </div>
            <div class="modal-body">
                <div class="breathing-container">
                    <p class="breathing-instruction" id="muscleInstruction">
                        We'll guide you through tensing and relaxing different muscle groups.
                    </p>
                    <p class="breathing-counter" id="muscleStep">Step 0/12</p>
                    <button class="exercise-btn" id="muscleBtn" onclick="startMuscleRelaxation()">Start</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Modal functions
        function openModal(type) {
            document.getElementById(type + 'Modal').classList.add('active');
            document.body.style.overflow = 'hidden';
            if (type === 'grounding') initGrounding();
            if (type === 'gratitude') randomGratitudePrompt();
        }

        function closeModal(type) {
            document.getElementById(type + 'Modal').classList.remove('active');
            document.body.style.overflow = '';
        }

        // Breathing Exercise
        let breathingInterval;
        let breathingCycles = 0;

        function startBreathing() {
            const btn = document.getElementById('breathingBtn');
            const circle = document.getElementById('breathingCircle');
            const text = document.getElementById('breathingText');
            const instruction = document.getElementById('breathingInstruction');

            if (btn.textContent === 'Start') {
                btn.textContent = 'Stop';
                breathingCycles = 0;
                runBreathingCycle();
            } else {
                btn.textContent = 'Start';
                clearTimeout(breathingInterval);
                circle.className = 'breathing-circle';
                text.textContent = 'Ready';
                instruction.textContent = 'Click Start to begin';
            }
        }

        function runBreathingCycle() {
            const circle = document.getElementById('breathingCircle');
            const text = document.getElementById('breathingText');
            const instruction = document.getElementById('breathingInstruction');
            const counter = document.getElementById('breathingCounter');

            // Inhale (4s)
            circle.className = 'breathing-circle inhale';
            text.textContent = '4';
            instruction.textContent = 'Breathe IN...';

            let countdown = 4;
            const inhaleInterval = setInterval(() => {
                countdown--;
                if (countdown > 0) text.textContent = countdown;
            }, 1000);

            breathingInterval = setTimeout(() => {
                clearInterval(inhaleInterval);
                // Hold (7s)
                circle.className = 'breathing-circle hold';
                text.textContent = '7';
                instruction.textContent = 'HOLD...';

                let holdCount = 7;
                const holdInterval = setInterval(() => {
                    holdCount--;
                    if (holdCount > 0) text.textContent = holdCount;
                }, 1000);

                breathingInterval = setTimeout(() => {
                    clearInterval(holdInterval);
                    // Exhale (8s)
                    circle.className = 'breathing-circle exhale';
                    text.textContent = '8';
                    instruction.textContent = 'Breathe OUT slowly...';

                    let exhaleCount = 8;
                    const exhaleInterval = setInterval(() => {
                        exhaleCount--;
                        if (exhaleCount > 0) text.textContent = exhaleCount;
                    }, 1000);

                    breathingInterval = setTimeout(() => {
                        clearInterval(exhaleInterval);
                        breathingCycles++;
                        counter.textContent = `Cycles completed: ${breathingCycles}`;

                        if (document.getElementById('breathingBtn').textContent === 'Stop') {
                            runBreathingCycle();
                        }
                    }, 8000);
                }, 7000);
            }, 4000);
        }

        // Grounding Exercise
        function initGrounding() {
            const counts = { see: 5, touch: 4, hear: 3, smell: 2, taste: 1 };
            Object.keys(counts).forEach(sense => {
                const container = document.getElementById(sense + 'Inputs');
                container.innerHTML = '';
                for (let i = 0; i < counts[sense]; i++) {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.placeholder = `${sense === 'see' ? 'I see' : sense === 'touch' ? 'I can touch' : sense === 'hear' ? 'I hear' : sense === 'smell' ? 'I smell' : 'I taste'}...`;
                    container.appendChild(input);
                }
            });
            resetGrounding();
        }

        function nextGroundingStep(currentStep) {
            const steps = document.querySelectorAll('.grounding-step');
            const dots = document.querySelectorAll('.progress-dot');

            if (currentStep < 5) {
                steps[currentStep - 1].classList.remove('active');
                steps[currentStep].classList.add('active');
                dots[currentStep - 1].classList.remove('active');
                dots[currentStep - 1].classList.add('completed');
                dots[currentStep].classList.add('active');
            } else {
                steps[4].classList.remove('active');
                dots[4].classList.remove('active');
                dots[4].classList.add('completed');
                document.getElementById('groundingComplete').classList.add('active');
            }
        }

        function resetGrounding() {
            const steps = document.querySelectorAll('.grounding-step');
            const dots = document.querySelectorAll('.progress-dot');

            steps.forEach((s, i) => s.classList.toggle('active', i === 0));
            dots.forEach((d, i) => {
                d.classList.remove('completed');
                d.classList.toggle('active', i === 0);
            });
            document.getElementById('groundingComplete').classList.remove('active');
        }

        // Mood Check
        let selectedMood = null;

        function selectMood(mood) {
            selectedMood = mood;
            document.querySelectorAll('.mood-option').forEach(opt => {
                opt.classList.toggle('selected', parseInt(opt.dataset.mood) === mood);
            });
        }

        function submitMood() {
            if (!selectedMood) {
                alert('Please select a mood first');
                return;
            }
            alert('Mood check-in complete! üåô');
            closeModal('mood');
            selectedMood = null;
            document.querySelectorAll('.mood-option').forEach(opt => opt.classList.remove('selected'));
        }

        // Gratitude
        const gratitudePrompts = [
            "What made you smile today?",
            "Name something you're grateful for.",
            "What's one good thing that happened this week?",
            "Who is someone you appreciate?",
            "What's a simple pleasure you enjoyed recently?"
        ];

        function randomGratitudePrompt() {
            const prompt = gratitudePrompts[Math.floor(Math.random() * gratitudePrompts.length)];
            document.getElementById('gratitudePrompt').textContent = prompt;
        }

        function submitGratitude() {
            const text = document.getElementById('gratitudeText').value;
            if (!text.trim()) {
                alert('Please write something');
                return;
            }
            alert('Gratitude noted! üåü');
            closeModal('gratitude');
            document.getElementById('gratitudeText').value = '';
        }

        // Sounds (visual only - no actual audio for demo)
        let selectedSound = null;
        let isPlaying = false;

        function selectSound(sound) {
            selectedSound = sound;
            document.querySelectorAll('.sound-option').forEach(opt => {
                opt.classList.toggle('active', opt.dataset.sound === sound);
            });
        }

        function setTimer(mins) {
            document.querySelectorAll('.timer-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function toggleSound() {
            if (!selectedSound) {
                alert('Please select a sound first');
                return;
            }
            isPlaying = !isPlaying;
            document.getElementById('playBtn').textContent = isPlaying ? '‚è∏Ô∏è Pause' : '‚ñ∂Ô∏è Play';
        }

        function stopAllSounds() {
            isPlaying = false;
            document.getElementById('playBtn').textContent = '‚ñ∂Ô∏è Play';
        }

        // Muscle Relaxation
        const muscleSteps = [
            "Tense your RIGHT HAND by making a fist... Hold for 5 seconds...",
            "Release and relax your right hand. Feel the tension melt away.",
            "Tense your LEFT HAND by making a fist... Hold for 5 seconds...",
            "Release and relax your left hand.",
            "Tense your SHOULDERS by raising them to your ears... Hold...",
            "Release your shoulders. Let them drop and relax.",
            "Tense your FACE by scrunching it tight... Hold...",
            "Release and smooth out your face. Relax your jaw.",
            "Tense your STOMACH muscles... Hold...",
            "Release your stomach. Breathe deeply.",
            "Tense your LEGS by pointing your toes... Hold...",
            "Release and let your legs go completely limp. You're fully relaxed! üåô"
        ];
        let muscleStep = 0;
        let muscleInterval;

        function startMuscleRelaxation() {
            const btn = document.getElementById('muscleBtn');
            const instruction = document.getElementById('muscleInstruction');
            const stepCounter = document.getElementById('muscleStep');

            if (btn.textContent === 'Start') {
                btn.textContent = 'Stop';
                muscleStep = 0;
                runMuscleStep();
            } else {
                btn.textContent = 'Start';
                clearTimeout(muscleInterval);
                muscleStep = 0;
                instruction.textContent = "We'll guide you through tensing and relaxing different muscle groups.";
                stepCounter.textContent = 'Step 0/12';
            }
        }

        function runMuscleStep() {
            const instruction = document.getElementById('muscleInstruction');
            const stepCounter = document.getElementById('muscleStep');

            if (muscleStep < muscleSteps.length) {
                instruction.textContent = muscleSteps[muscleStep];
                stepCounter.textContent = `Step ${muscleStep + 1}/12`;
                muscleStep++;
                muscleInterval = setTimeout(runMuscleStep, 5000);
            } else {
                document.getElementById('muscleBtn').textContent = 'Start';
            }
        }

        // Theme toggle
        const themeSwitch = document.getElementById('theme-switch');
        const savedTheme = localStorage.getItem('moonline-theme');
        if (savedTheme === 'light') {
            document.body.classList.add('light-mode');
            themeSwitch.checked = true;
        }
        themeSwitch.addEventListener('change', () => {
            document.body.classList.toggle('light-mode');
            localStorage.setItem('moonline-theme', document.body.classList.contains('light-mode') ? 'light' : 'dark');
        });
    </script>
</body>
</html>

